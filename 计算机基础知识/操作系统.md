# 目录

[toc]
## 进程与线程
对于有线程系统：
* 进程是资源分配的独立单位
* 线程是资源调度的独立单位

对于无线程系统：
* 进程是资源调度、分配的独立单位

### 进程之间通信方式以及优缺点
* 管道(PIPE)
    * 有名管道：一种半双工的通信方式，它允许无亲缘关系进程间通信
        * 优点：可以实现任意关系的进程间通信
        * 缺点：
            * 长期存于系统中，使用不当容易出错
            * 缓冲区有限
    * 无名管道：一种半双工的通信方式，只能在具有亲缘关系的进程间使用（父子进程）
        * 优点：简单方便
        * 缺点
            * 局限于单向通信
            * 只能创建在它的进程以及其有亲缘关系的进程之间
            * 缓冲区有限
* 信号量(Semaphore):一个计数器，可以用来控制多个线程对共享资源的访问
    * 优点：可以同步进程
    * 缺点：信号量有限
* 信号(Signal)：一种比较复杂的通信方式，用于通知接收进程某个事件已经发生
* 消息队列（Message Queue）：是消息的链表，存放在内核中并由消息队列标识符标识
    * 优点：可以实现任意进程间的通信，并通过系统调用函数来实现消息发送和接收之间的同步，无需考虑同步问题，方便
    * 缺点：信息的幅值需要额外消耗CPU时间，不适宜于信息量大或操作频繁的场合
* 共享内存（Shared Memory）：映射一段内被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问：
    * 优点：无须复制，快捷，信息量大
    * 缺点：
        * 通信是通过将共享空间缓冲区直接附加到进程的虚拟地址空间中来实现的，因此进程间的读写操作的同步问题
        * 利用内存缓冲区直接交换信息，内存的实体存在于计算机中，只能同一个计算机系统中的诸多进程共享，不方便网络通信
* 套接字(Socket)：可用于不同计算机间的进程通信
    * 优点：
        * 传输数据为字节级，传输数据可自定义，数据量小效率高
        * 传输数据时间短，性能高
        * 适合与客户端和服务器端之间信息实时交互
        * 可以加密，数据安全性强
    * 缺点：需对传输的数据进行解析，转化成应用级的数据。

### 线程之间的通信方式
* 锁机制：包括互斥锁/量(mutex)、读写锁(reder-writer lock)、自旋锁(spin lock)、条件变量(condition)
    * 互斥锁/量(mutex)：提供了以排他方式防止数据结构被并发修改的方法
    * 读写锁（reader-writer lock）：允许多个线程同时读共享数据，而对写操作是互斥的。
    * 自旋锁（spin lock）与互斥锁类似，都是为了保护共享资源。互斥锁是当资源被占用，申请者进入睡眠状态；而自旋锁则循环检测保持者是否已经释放锁。
    * 条件变量（condition）：可以以原子的方式阻塞进程，直到某个特定条件为真为止。对条件的测试是在互斥锁的保护下进行的。条件变量始终与互斥锁一起使用。
* 信号量机制(Semaphone)
    * 无名线程信号量
    * 命名线程信号量
* 信号机制(Signal)：类似进程间的信号处理
* 屏障(barrier)：屏障允许每个线程等待，知道所有的合作线程都达到某一点，然后从该点继续执行

### 进程之间私有和共享的资源
> * 私有:地址空间、堆、全局变量、栈、寄存器
> * 共享：代码段、公共数据、进程目录、进程ID

### 线程之间私有和共享的资源
> * 私有:线程栈、寄存器、程序计数器
> * 共享：堆、地址空间、全局变量、静态变量

### 进程的三种状态及转换

* 运行态：进程占用CPU，并在CPU上运行
* 就绪态：进程已经具备运行条件，但是CPU还没有分配过来
* 阻塞台：进程因等待某时间发生而暂时不能运行

![进程状态转换图](https://img-blog.csdn.net/20180802141010826?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JleW9uZF8yMDE2/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

### 进程与线程的区别

1. 进程是资源分配的最小单位，线程是程序执行的最小单位
2. 进程有自己独立的地址空间，每启动一个进程，系统都会为其分配地址空间，建立数据表来维护代码段、堆栈段和数据段，线程没有独立的地址空间，它使用相同额地址空间共享数据
3. CPU切换一个线程比切换进程花费小
4. 创建一个线程比进程开销小
5. 线程占用的资源要⽐进程少很多。
6. 线程之间通信更方便，同一个进程下，线程共享全局变量，静态变量等数据，进程之间的通信需要以通信的方式（IPC）进行；（但多线程程序处理好同步与互斥是个难点）
7. 多进程程序更安全，生命力更强，一个进程死掉不会对另一个进程造成影响（源于有独立的地址空间），多线程程序更不易维护，一个线程死掉，整个进程就死掉了（因为共享地址空间）；
8. 进程对资源保护要求高，开销大，效率相对较低，线程资源保护要求不高，但开销小，效率高，可频繁切换；